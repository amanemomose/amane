<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Copa dos Personagens</title>
  <style>
    body {
      font-family: sans-serif;
      background: #eef2f7;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
    }
    #menu, #jogos, #resultadoFinal {
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      margin-top: 20px;
    }
    .personagemCard {
      display: inline-block;
      width: 100px;
      margin: 5px;
      text-align: center;
      background: #f8f9fa;
      border-radius: 8px;
      padding: 5px;
      font-size: 12px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      cursor: grab;
    }
    .personagemCard img {
      width: 100%;
      height: auto;
      border-radius: 6px;
    }
    .brackets {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 20px;
    }
    .slot {
      width: 180px;
      height: 250px;
      background: #ddd;
      border-radius: 10px;
      text-align: center;
      line-height: 250px;
      font-weight: bold;
      color: #888;
      position: relative;
    }
    .slot img {
      width: 100%;
      height: auto;
      border-radius: 10px;
      position: absolute;
      top: 0;
      left: 0;
      object-fit: cover;
    }
    .slot .nome {
      position: absolute;
      bottom: 0;
      width: 100%;
      background: rgba(0,0,0,0.6);
      color: white;
      font-size: 14px;
    }
    .jogo {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin: 30px 0;
    }
    .jogo .card {
      width: 250px;
      text-align: center;
    }
    .jogo .card img {
      width: 100%;
      border-radius: 10px;
    }
    .versus {
      font-size: 36px;
      font-weight: bold;
    }
    .status {
      font-size: 14px;
      margin-top: 10px;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #2980b9;
    }
  </style>
</head>
<body>
  <div id="menu">
    <h1>Copa dos Personagens</h1>
    <label for="tamanho">Tamanho do Torneio:</label>
    <select id="tamanho">
      <option value="8">8</option>
      <option value="16">16</option>
      <option value="24">24</option>
    </select>
    <br><br>
    <p>Arraste os personagens desejados para os espa√ßos do torneio:</p>
    <div id="personagensLista"></div>
    <h3>Chaves do Torneio</h3>
    <div id="brackets" class="brackets"></div>
    <button onclick="preencherAutomaticamente()">Preencher Automaticamente</button>
    <button onclick="iniciarTorneio()">Iniciar Torneio</button>
  </div>

  <div id="jogos" style="display:none;"></div>
  <div id="resultadoFinal" style="display:none;"></div>

  <script>
    let personagensOriginais = [
      { nome: "Lu Fufu", imagem: "https://i.imgur.com/6BoV7d9.png", F: 5, S: 3, P: 4, I: 6, C: 2 },
      { nome: "Komi Shouko", imagem: "https://i.imgur.com/MTsAdDy.png", F: 2, S: 5, P: 3, I: 4, C: 6 },
      { nome: "Bocchi", imagem: "https://i.imgur.com/0cIWfYb.png", F: 2, S: 2, P: 3, I: 4, C: 5 },
      { nome: "C.C.", imagem: "https://i.imgur.com/MHDGXr5.png", F: 4, S: 5, P: 4, I: 6, C: 3 },
      { nome: "Aqua", imagem: "https://i.imgur.com/gJzUZ1u.png", F: 1, S: 4, P: 5, I: 2, C: 6 },
      { nome: "Denji", imagem: "https://i.imgur.com/NbSw4al.png", F: 6, S: 3, P: 4, I: 2, C: 4 },
      { nome: "Okabe", imagem: "https://i.imgur.com/NEX0nbf.png", F: 3, S: 2, P: 5, I: 6, C: 3 },
      { nome: "Pomni", imagem: "https://i.imgur.com/cZgrk2W.png", F: 3, S: 4, P: 2, I: 5, C: 4 }
    ];
    let personagens = [...personagensOriginais];
    let brackets = [];
    let rodadaAtual = [];
    let proximaRodada = [];
    let rodadaIndex = 0;

    const tamanhoSelect = document.getElementById("tamanho");
    tamanhoSelect.addEventListener("change", () => criarBrackets());

    function renderPersonagens() {
      const lista = document.getElementById("personagensLista");
      lista.innerHTML = "";
      personagens.forEach((p, i) => {
        const card = document.createElement("div");
        card.className = "personagemCard";
        card.draggable = true;
        card.dataset.index = i;
        card.innerHTML = `
          <img src="${p.imagem}" alt="${p.nome}">
          <div>${p.nome}</div>
        `;
        card.addEventListener("dragstart", e => {
          e.dataTransfer.setData("text/plain", i);
        });
        lista.appendChild(card);
      });
    }

    function criarBrackets() {
      const qtd = parseInt(tamanhoSelect.value);
      const container = document.getElementById("brackets");
      container.innerHTML = "";
      brackets = [];
      for (let i = 0; i < qtd; i++) {
        const slot = document.createElement("div");
        slot.className = "slot";
        slot.textContent = "Solte aqui";
        slot.ondragover = e => e.preventDefault();
        slot.ondrop = e => {
          const idx = e.dataTransfer.getData("text/plain");
          const p = personagens[idx];
          if (p && !brackets.includes(p)) {
            slot.innerHTML = `<img src="${p.imagem}"><div class="nome">${p.nome}</div>`;
            brackets[i] = p;
            personagens.splice(idx, 1);
            renderPersonagens();
          }
        };
        container.appendChild(slot);
        brackets.push(null);
      }
    }

    function preencherAutomaticamente() {
      for (let i = 0; i < brackets.length; i++) {
        if (!brackets[i] && personagens.length > 0) {
          brackets[i] = personagens.shift();
        }
      }
      criarBrackets();
    }

    function iniciarTorneio() {
      if (brackets.filter(Boolean).length < 2 || brackets.filter(Boolean).length % 2 !== 0) {
        alert("O n√∫mero de participantes deve ser par e maior que 1.");
        return;
      }
      rodadaAtual = [...brackets.filter(Boolean)];
      document.getElementById("menu").style.display = "none";
      document.getElementById("jogos").style.display = "block";
      rodadaIndex = 0;
      proximaRodada = [];
      mostrarPartida();
    }

    function mostrarPartida() {
      const container = document.getElementById("jogos");
      container.innerHTML = "";
      if (rodadaAtual.length === 1) {
        exibirCampeao(rodadaAtual[0]);
        return;
      }
      const p1 = rodadaAtual[rodadaIndex];
      const p2 = rodadaAtual[rodadaIndex + 1];
      const jogo = document.createElement("div");
      jogo.className = "jogo";
      jogo.innerHTML = `
        <div class="card">
          <img src="${p1.imagem}" alt="${p1.nome}">
          <h3>${p1.nome}</h3>
          <div class="status">F: ${p1.F} | S: ${p1.S} | P: ${p1.P} | I: ${p1.I} | C: ${p1.C}</div>
          <button onclick="selecionarVencedor(${rodadaIndex}, 0)">Escolher</button>
        </div>
        <div class="versus">VS</div>
        <div class="card">
          <img src="${p2.imagem}" alt="${p2.nome}">
          <h3>${p2.nome}</h3>
          <div class="status">F: ${p2.F} | S: ${p2.S} | P: ${p2.P} | I: ${p2.I} | C: ${p2.C}</div>
          <button onclick="selecionarVencedor(${rodadaIndex}, 1)">Escolher</button>
        </div>
      `;
      container.appendChild(jogo);
    }

    function selecionarVencedor(index, escolhido) {
      const vencedor = escolhido === 0 ? rodadaAtual[index] : rodadaAtual[index + 1];
      proximaRodada.push(vencedor);
      rodadaIndex += 2;
      if (rodadaIndex >= rodadaAtual.length) {
        rodadaAtual = [...proximaRodada];
        proximaRodada = [];
        rodadaIndex = 0;
      }
      mostrarPartida();
    }

    function exibirCampeao(vencedor) {
      document.getElementById("jogos").style.display = "none";
      const final = document.getElementById("resultadoFinal");
      final.style.display = "block";
      final.innerHTML = `
        <h2>üèÜ Campe√£o: ${vencedor.nome} üèÜ</h2>
        <img src="${vencedor.imagem}" alt="${vencedor.nome}" style="width: 300px; border-radius: 20px;">
        <div class="status">F: ${vencedor.F} | S: ${vencedor.S} | P: ${vencedor.P} | I: ${vencedor.I} | C: ${vencedor.C}</div>
        <br><br>
        <button onclick="location.reload()">Voltar ao In√≠cio</button>
      `;
    }

    renderPersonagens();
    criarBrackets();
  </script>
</body>
</html>
